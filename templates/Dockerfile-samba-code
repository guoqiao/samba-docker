FROM samba-env

ENV PYTHONPATH="{{SAMBA_REPO_DIR}}/bin/python"
# these locale env vars are required for make
ENV LANGUAGE=en_US:en LANG=en_US.UTF-8 LC_ALL=en_US.UTF-8

RUN mkdir -p {{SAMBA_REPO_DIR}}
WORKDIR {{SAMBA_REPO_DIR}}

RUN git clone --depth 30 --branch {{SAMBA_REPO_BRANCH}} {{SAMBA_REPO_URL}} . && ./configure.developer && make -j && sudo make install

ADD --chown=samba *.sh ./
RUN chmod a+x *.sh
